<html>
<body>
<button onclick='window2=beginNotate(getInfo,"xyz")'>Begin Notate</button>
<a href="
javascript:(function(){
	const w = open('','empty!');
	const style = w.document.head.appendChild(document.createElement('style'));
	style.textContent = '#main,.sub {display: grid; grid-template-columns: repeat(2, 1fr); column-gap: 2rem; row-gap: 1rem;};
	const div = w.document.body.appendChild(document.createElement('div'));
	div.id = 'main';
	const b = document.body.appendChild(document.createElement('button'));
	b.textContent = 'add to window2';
	b.onclick = function(){
		let text = prompt('what?!');
		let info = {'Key':'val', 'Key2':'val2'};
		let sdiv = div.appendChild(document.createElement('div'));
		sdiv.classList.add('sub');
		let a = sdiv.appendChild(document.createElement('div'));
		for (const [key,val] of Object.entries(info)){
			a.appendChild(document.createElement('b')).textContent = key;
			a.appendChild(document.createTextNode(': '+val));
			a.appendChild(document.createElement('br'));
		}
		let b = sdiv.appendChild(document.createElement('textarea'));
		b.value = text;
	};
})();">BeginNotate()</a>
</body>
<script>
function getInfo(){
	return {
		'shortKey':'shortVal'
		, 'shortKey2':'notSoShortVal'
		, 'shortKey3':'notSoLongVal'
		, 'kindaLongKey':'shortVal'
		, 'kindaLongKey2':'somewhatLongVal'
	};
}

function beginNotate(exinfo){
	const w = open('','empty!');
	const style = w.document.head.appendChild(document.createElement('style'));
	style.textContent = '#main,.sub {display: grid;gap: 1rem;}#main{grid-template-columns: repeat(2, 1fr);}.sub{ grid-template-columns: max-content auto; } table {font-family: courier new;border-collapse:collapse;} th {text-align: left; } @media print {textarea{border:0;font:1em arial;}}';
	const div = w.document.body.appendChild(document.createElement('div'));
	div.id = 'main';
	const b = document.body.appendChild(document.createElement('button'));
	b.textContent = 'add to window2';
	b.onclick = function(){
		let sc = prompt('subcode?');
		let text = prompt('note?');
		let info = exinfo();
		let sdiv = div.querySelector('.sub'+sc);
		if (sdiv){
			sdiv.querySelector('textarea').value += '\n'+text;
		} else {
			sdiv = div.appendChild(document.createElement('div'));
			sdiv.classList.add('sub'+sc,'sub');
			let a = sdiv.appendChild(document.createElement('table'));
			a.contentEditable = 'true';
			let tr;
			for (const [key,val] of Object.entries(info)){
				tr = a.appendChild(document.createElement('tr'));
				tr.appendChild(document.createElement('th')).textContent = key;
				tr.appendChild(document.createElement('td')).textContent = val;
			}
			let b = sdiv.appendChild(document.createElement('textarea'));
			b.value = sc+'\n'+text;
		}
	};
	return w;
}
var window2;

</script>
</html>