<html>
<head>
<title>Scatter!!</title>
<style>
	body {
		margin: 0;
		background: #fff;
	}
	canvas {
		position: absolute;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		margin: auto;
		z-index: -1;
	}
	h3 {
		margin: 0;
	}
	#topmenu {
		background: #eee;
		width: 100%;
	}
	#sidemenu button {
		border: 0;
	}
	#controls, #data {
		float: left;
		background: #eee;
		padding: 0.5em;
		border: 1px outset gray;
	}
	#data textarea {
		width: 100%;
		height: 3em;
		resize: vertical;
	}
	#data select {
		width: 100%;
		height: 12em;
	}
</style>
<script src='scatterplot.js'></script>
</head>
<div id='topmenu'>
<button onclick='showMenu("controls")'>CONTROLS</button>
<button onclick='showMenu("data")'>DATA</button>
</div>
<div id='controls'>
	<h3>Controls</h3>
	<label for='xview'>XView<br /><input id='xview' /></label><br />
	<label for='yview'>YView<br /><input id='yview' /></label><br />
	<label for='gridxy'>Grid<br /><input id='gridxy' /></label><br />
	<button onclick='setView(maingraph);'>Set</button><button onclick=''>Auto</button>
</div>
<div id='data'>
	<h3>Data</h3>
	<label for='points'>Input<br /><textarea id='points'></textarea></label><br />
	<button onclick=''>Add</button><br />
	<hr />
	<label for='pointsList'>Displayed<br />
	<select id='pointsList' name='point' multiple></select></label><br />
	<button onclick=''>Pop</button><br />
</div>
<canvas id='mycan' width='400px' height='300px'></canvas>

<script>
	var currentMenu = undefined;
	function showMenu(menu){
		if (currentMenu === menu){
			toggleHide(currentMenu);
			currentMenu = undefined;
		} else {
			if (!(currentMenu === undefined)){
				toggleHide(currentMenu);
			}
			currentMenu = menu;
			toggleHide(currentMenu);
		}
	}
	function toggleHide(ele){
		let div = document.getElementById(ele);
		div.style.display = div.style.display == "none" ? "block" : "none";
	}
	function validSplit(val, splitchar){
		let [x,y] = val.split(splitchar, 2);
		return (x && y) ? [x,y] : [];
	}
	function setView(graph){
		let xview = validSplit(getValueFrom('xview'), ',').map(Number);
		console.log(xview);
		if (xview.length>0 && xview[0] < xview[1]){
			graph.xview = xview;
		}
		let yview = validSplit(getValueFrom('yview'), ',').map(Number);
		if (yview.length>0 && yview[0] < yview[1]){
			graph.yview = yview;
		}
		let gridxy = validSplit(getValueFrom('gridxy'), ',').map(Number);
		if (gridxy.length>0 && gridxy[0] > 0 && gridxy[1] > 0){
			graph.gridxy = gridxy;
		}
		console.log(graph);
	}
	function getValueFrom(name){
		return document.getElementById(name).value;
	}

	document.getElementById('controls').style.display = 'none';
	document.getElementById('data').style.display = 'none';

	var maingraph = new Graph();
	let points = sortedPointArray(
		xvals = Array(-4,-3,-2,-1,0,1,2,3,4),
		yvals = Array(-64,-27,-8,-1,0,1,8,27,64)
	);

	let xview = [points[0].x, points[points.length-1].x];
	let yview = getMinAndMax(points, (point) => point.y);

	let can = document.getElementById('mycan');
	let xscale = calculateScale(xview, can.width);
	let yscale = calculateScale(yview, can.height);
	
	canvasBg(can);
	gridLines(xscale, xview, xinterval=1, yscale, yview, yinterval=5, can);
	originLines(xscale, xview, yscale, yview, can);
	plotPoints(points, xscale, yscale, xview, yview, can);

</script>
</html>

